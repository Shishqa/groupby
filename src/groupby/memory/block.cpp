///////////////////////////////////////////////////////////////////////////////

#include "block.hpp"

///////////////////////////////////////////////////////////////////////////////
namespace groupby {
///////////////////////////////////////////////////////////////////////////////

RelationIn BlockRead(Block& b, RelationIn in) {
  auto end = RelationIn();
  const size_t capacity = b.capacity();
  b.clear();
  for (; in != end && b.size() < capacity; ++in) {
    b.emplace_back(std::move(*in));
  }
  return in;
}

RelationOut BlockWrite(const Block& b, RelationOut out) {
  for (size_t i = 0; i < b.size(); ++i, ++out) {
    *out = b[i];
  }
  return out;
}

///////////////////////////////////////////////////////////////////////////////
}  // namespace groupby
///////////////////////////////////////////////////////////////////////////////
